<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Benny's Ears</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>👂</text></svg>">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>

<body>
    <div class="container">
        <header>
            <h1>What's in <a href="https://bennymagid.com">Benny's</a> Ears</h1>
            <subtitle>Powered by <a href="https://www.last.fm/api#getting-started">Last.fm API</a> - see my <a
                    href="https://www.last.fm/user/bmahid">Last.fm</a> or my <a
                    href="https://open.spotify.com/user/1287562186">Spotify</a> for more</a></subtitle>
            <div class="controls">
                <div class="toggle-group">
                    <button class="toggle-option" data-group="live-mode" data-value="live" title="Live mode">
                        <span class="control-icon">🔴</span>
                        <span class="control-label">Live</span>
                    </button>
                    <button class="toggle-option" data-group="live-mode" data-value="paused" title="Paused">
                        <span class="control-icon">⚫</span>
                        <span class="control-label">Paused</span>
                    </button>
                </div>

                <div class="toggle-group">
                    <button class="toggle-option" data-group="theme" data-value="dark" title="Dark theme">
                        <span class="control-icon">🌙</span>
                        <span class="control-label">Dark</span>
                    </button>
                    <button class="toggle-option" data-group="theme" data-value="light" title="Light theme">
                        <span class="control-icon">☀️</span>
                        <span class="control-label">Light</span>
                    </button>
                    <button class="toggle-option" data-group="theme" data-value="system" title="System theme">
                        <span class="control-icon">💻</span>
                        <span class="control-label">System</span>
                    </button>
                </div>
            </div>
        </header>

        <section class="last-played-hero" id="last-played">
            <div class="loading">Loading current track...</div>
        </section>

        <section class="top-artists-section">
            <div class="section-header">
                <h2 class="section-title">🔝 Top Artists</h2>
                <select id="period-selector" class="period-selector">
                    <option value="7day">This Week</option>
                    <option value="1month" selected>This Month</option>
                    <option value="3month">Last 3 Months</option>
                    <option value="6month">Last 6 Months</option>
                    <option value="12month">This Year</option>
                    <option value="overall">All Time</option>
                </select>
            </div>
            <div id="top-artists" class="top-artists-list">
                <div class="loading">Loading top artists...</div>
            </div>
        </section>

        <section class="chart-section">
            <div class="section-header">
                <h2 class="section-title">📈 Listening History</h2>
            </div>
            <div id="chart-loading" class="chart-loading" style="display: none;">
                Loading chart...
            </div>
            <div class="chart-container">
                <canvas id="artist-chart"></canvas>
            </div>
        </section>

        <section class="chart-section">
            <div class="genre-charts-grid">
                <div class="genre-chart-column">
                    <div class="section-header">
                        <h2 class="section-title">🎵 Genre Evolution</h2>
                    </div>
                    <div id="genre-loading" class="chart-loading" style="display: none;">
                        Loading genre data...
                    </div>
                    <div class="chart-container">
                        <canvas id="genre-chart"></canvas>
                    </div>
                </div>
                <div class="genre-chart-column">
                    <div class="section-header">
                        <h2 class="section-title">🏅 Top Genres</h2>
                        <select id="genre-period-selector" class="period-selector">
                            <option value="1month" selected>This Month</option>
                            <option value="3month">Last 3 Months</option>
                            <option value="12month">This Year</option>
                        </select>
                    </div>
                    <div id="genre-bar-loading" class="chart-loading" style="display: none;">
                        Loading genre data...
                    </div>
                    <div class="chart-container">
                        <canvas id="genre-bar-chart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <section class="music-stats-section">
            <div class="section-header">
                <h2 class="section-title">📊 Music Stats</h2>
                <select id="stats-period-selector" class="period-selector">
                    <option value="1month" selected>This Month</option>
                    <option value="3month">Last 3 Months</option>
                    <option value="12month">This Year</option>
                </select>
            </div>
            <div id="stats-loading" class="chart-loading" style="display: none;">
                Loading stats...
            </div>
            <div class="stats-grid">
                <div class="stat-card">
                    <h3 class="stat-title">Average Hipster Score</h3>
                    <div id="avg-hipster-score" class="big-stat">--</div>
                    <div id="hipster-label" class="stat-label">Loading...</div>
                    <div id="hipster-cutoffs" class="score-cutoffs"></div>
                </div>
                <div class="stat-card">
                    <h3 class="stat-title">Hipster Distribution</h3>
                    <div class="chart-container-small">
                        <canvas id="hipster-donut"></canvas>
                    </div>
                </div>
                <div class="stat-card">
                    <h3 class="stat-title">Artist Diversity</h3>
                    <div id="diversity-percentage" class="big-stat">--</div>
                    <div id="diversity-label" class="stat-label">of plays from top artist</div>
                    <div id="top-artist-name" class="stat-sublabel">--</div>
                </div>
            </div>
        </section>

        <section class="top-artists-section">
            <div class="section-header">
                <h2 class="section-title collapsicble" id="recently-played-toggle">
                    ⏱️ Recently Played
                    <span class="collapse-icon">▼</span>
                </h2>
            </div>
            <div id="tracks" class="tracks-grid">
                <div class="loading">Loading tracks...</div>
            </div>
        </section>

        <section class="explanation-section">
            <h2 class="section-title">🎯 About Hipster Score</h2>
            <div id="hipster-explanation" class="explanation-content"></div>
        </section>

        <footer class="footer">
            Made with ❤️ by <a href="https://bennymagid.com">Benny Magid</a><br>
            Built with <a href="https://www.claude.com/product/claude-code">Claude Code</a> • Colors from <a href="https://catppuccin.com/palette/">Catppuccin</a> • See updates on <a href="https://github.com/bennymagid/last_fm_reader">GitHub</a>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>

</html>